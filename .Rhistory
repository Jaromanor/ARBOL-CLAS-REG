knitr::opts_chunk$set(echo = TRUE)
library(rpart)
data(kyphosis)
library(rpart)
data(kyphosis)
str(kyphosis)
library(mlr3verse)
library(caret)
library(caret)
set.seed(123)
indices<-createDataPartition(kyphosis$Kyphosis,p=0.7,list = FALSE)
train<-kyphosis[indices,]
test<-kyphosis[-indices,]
View(train)
?rpart
arbol_ini<-rpart(kyphosis~.,data = kyphosis,method = "class")
View(kyphosis)
arbol_ini<-rpart(Kyphosis~.,data = kyphosis,method = "class")
library(rpart.plot)
install.packages("rpart.plot")
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 104)
?rpart.plot
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 106)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 106)
View(kyphosis)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 108)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 0)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 1)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 10)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 1)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 8)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 104)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 108)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 2)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 104)
printcp(arbol_ini)
arbol_podado <- prune(arbol_ini,
cp = arbol_ini$cptable[which.min(arbol_ini$cptable[, "xerror"]), "CP"])
rpart.plot(arbol_podado, type = 3, extra = 104)
arbol_ini
printcp(arbol_ini)
pred_test <- predict(arbol_podado, newdata = test, type = "class")
pred_test
table(Predicted = pred_test, Actual = test$Kyphosis)
View(kyphosis)
table(kyphosis$Kyphosis)
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 1)
library(CDR)
# Paso 1: cargar librerías
library(rpart)
library(rpart.plot)
# Paso 2: crear el dataframe
datos <- data.frame(
Día = 1:15,
Tipo_de_día = c("Soleado", "Soleado", "Lluvia", "Nublado", "Lluvia",
"Lluvia", "Soleado", "Nublado", "Soleado", "Lluvia",
"Soleado", "Nublado", "Nublado", "Lluvia", "Soleado"),
Humedad = c("Fuerte", "Fuerte", "Fuerte", "Fuerte", "Débil",
"Débil", "Fuerte", "Débil", "Débil", "Débil",
"Débil", "Fuerte", "Débil", "Fuerte", "Fuerte"),
Viento = c("Débil", "Fuerte", "Débil", "Débil", "Débil",
"Fuerte", "Débil", "Fuerte", "Débil", "Débil",
"Fuerte", "Fuerte", "Débil", "Fuerte", "Fuerte"),
Decisión = c("NO", "NO", "SÍ", "SÍ", "SÍ",
"NO", "NO", "SÍ", "SÍ", "SÍ",
"SÍ", "SÍ", "SÍ", "SÍ", "NO")
)
# Convertir variables categóricas
datos$Tipo_de_día <- as.factor(datos$Tipo_de_día)
datos$Humedad <- as.factor(datos$Humedad)
datos$Viento <- as.factor(datos$Viento)
datos$Decisión <- as.factor(datos$Decisión)
set.seed(123)
idx <- sample(1:15, size = 10)
train <- datos[idx, ]
test <- datos[-idx, ]
arbol <- rpart(Decisión ~ Tipo_de_día + Humedad + Viento,
data = train,
method = "class",
control = rpart.control(cp = 0))
printcp(arbol)
arbol_podado <- prune(arbol, cp = cp_min)
cp_min <- arbol$cptable[which.min(arbol$cptable[, "xerror"]), "CP"]
arbol_podado <- prune(arbol, cp = cp_min)
arbol_podado
rpart.plot(arbol_podado, type = 3, extra = 104)
library(rpart)
library(caret)
library(rpart.plot)
printcp(arbol_ini)
arbol_ini$cptable
arbol_ini$cptable[, "xerror"]
arbol_ini$cptable[, "xerror", "CP"]
arbol_ini$cptable[,c("xerror", "CP")]
knitr::opts_chunk$set(echo = TRUE)
arbol_podado <- prune(arbol_ini,
cp = arbol_ini$cptable[which.min(arbol_ini$cptable[, "xerror"]), "CP"])
rpart.plot(arbol_podado, type = 3, extra = 104)
pred_test <- predict(arbol_podado, newdata = test, type = "class")
View(test)
library(rpart)
data(kyphosis)
str(kyphosis)
library(caret)
set.seed(123)
indices<-createDataPartition(kyphosis$Kyphosis,p=0.7,list = FALSE)
train<-kyphosis[indices,]
test<-kyphosis[-indices,]
arbol_ini<-rpart(Kyphosis~.,data = kyphosis,method = "class")
library(rpart.plot)
rpart.plot(arbol_ini, type = 3, extra = 1)
printcp(arbol_ini)
arbol_podado <- prune(arbol_ini,
cp = arbol_ini$cptable[which.min(arbol_ini$cptable[, "xerror"]), "CP"])
rpart.plot(arbol_podado, type = 3, extra = 104)
pred_test <- predict(arbol_podado, newdata = test, type = "class")
table(Predicted = pred_test, Actual = test$Kyphosis)
pred_test <- predict(arbol_ini, newdata = test, type = "class")
pred_test_1 <- predict(arbol_podado, newdata = test, type = "class")
table(Predicted = pred_test_1, Actual = test$Kyphosis)
pred_test_2 <- predict(arbol_ini, newdata = test, type = "class")
table(Predicted = pred_test_2, Actual = test$Kyphosis)
table(Predicted = pred_test_2, Actual = test$Kyphosis)
table(Predicted = pred_test_1, Actual = test$Kyphosis)
arbol_ini$cptable[which.min(arbol_ini$cptable[, "xerror"]), "CP"])
arbol_ini$cptable[which.min(arbol_ini$cptable[, "xerror"]), "CP"]
View(kyphosis)
